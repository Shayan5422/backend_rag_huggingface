{
    "model_id": "RedHatAI/Meta-Llama-3.1-8B-Instruct-quantized.w4a16",
    "downloads": 102010,
    "tags": [
        "transformers",
        "safetensors",
        "llama",
        "text-generation",
        "int4",
        "vllm",
        "conversational",
        "en",
        "de",
        "fr",
        "it",
        "pt",
        "hi",
        "es",
        "th",
        "base_model:meta-llama/Llama-3.1-8B-Instruct",
        "base_model:quantized:meta-llama/Llama-3.1-8B-Instruct",
        "license:llama3.1",
        "autotrain_compatible",
        "text-generation-inference",
        "endpoints_compatible",
        "4-bit",
        "gptq",
        "region:us"
    ],
    "description": "--- tags: - int4 - vllm language: - en - de - fr - it - pt - hi - es - th pipeline_tag: text-generation license: llama3.1 base_model: meta-llama/Meta-Llama-3.1-8B-Instruct --- # Meta-Llama-3.1-8B-Instruct-quantized.w4a16 ## Model Overview - **Model Architecture:** Meta-Llama-3 - **Input:** Text - **Output:** Text - **Model Optimizations:** - **Weight quantization:** INT4 - **Intended Use Cases:** Intended for commercial and research use in English. Similarly to Meta-Llama-3.1-8B-Instruct, this models is intended for assistant-like chat. - **Out-of-scope:** Use in any manner that violates applicable laws or regulations (including trade compliance laws). Use in languages other than English. - **Release Date:** 7/26/2024 - **Version:** 1.0 - **License(s):** Llama3.1 - **Model Developers:** Neural Magic This model is a quantized version of Meta-Llama-3.1-8B-Instruct. It was evaluated on a several tasks to assess the its quality in comparison to the unquatized model, including multiple-choice, math reasoning, and open-ended text generation. Meta-Llama-3.1-8B-Instruct-quantized.w4a16 achieves 93.0% recovery for the Arena-Hard evaluation, 98.9% for OpenLLM v1 (using Meta's prompting when available), 96.1% for OpenLLM v2, 99.7% for HumanEval pass@1, and 97.4% for HumanEval+ pass@1. ### Model Optimizations This model was obtained by quantizing the weights of Meta-Llama-3.1-8B-Instruct to INT4 data type. This optimization reduces the number of bits per parameter from 16 to 4, reducing the disk size and GPU memory requirements by approximately 75%. Only the weights of the linear operators within transformers blocks are quantized. Symmetric per-group quantization is applied, in which a linear scaling per group of 128 parameters maps the INT4 and floating point representations of the quantized weights. AutoGPTQ is used for quantization with 10% damping factor and 768 sequences taken from Neural Magic's LLM compression calibration dataset. ## Deployment This model can be deployed efficiently using the vLLM backend, as shown in the example below. vLLM aslo supports OpenAI-compatible serving. See the documentation for more details. ## Creation This model was created by applying the AutoGPTQ library as presented in the code snipet below. Although AutoGPTQ was used for this particular model, Neural Magic is transitioning to using llm-compressor which supports several quantization schemes and models not supported by AutoGPTQ. ## Evaluation This model was evaluated on the well-known Arena-Hard, OpenLLM v1, OpenLLM v2, HumanEval, and HumanEval+ benchmarks. In all cases, model outputs were generated with the vLLM engine. Arena-Hard evaluations were conducted using the Arena-Hard-Auto repository. The model generated a single answer for each prompt form Arena-Hard, and each answer was judged twice by GPT-4. We report below the scores obtained in each judgement and the average. OpenLLM v1 and v2 evaluations were conducted using Neural Magic's fork of lm-evaluation-harness (branch llama_3.1_instruct). This version of the lm-evaluation-harness includes versions of MMLU, ARC-Challenge and GSM-8K that match the prompting style of Meta-Llama-3.1-Instruct-evals and a few fixes to OpenLLM v2 tasks. HumanEval and HumanEval+ evaluations were conducted using Neural Magic's fork of the EvalPlus repository. Detailed model outputs are available as HuggingFace datasets for Arena-Hard, OpenLLM v2, and HumanEval. **Note:** Results have been updated after Meta modified the chat template. ### Accuracy <table> <tr> <td><strong>Category</strong> </td> <td><strong>Benchmark</strong> </td> <td><strong>Meta-Llama-3.1-8B-Instruct </strong> </td> <td><strong>Meta-Llama-3.1-8B-Instruct-quantized.w4a16 (this model)</strong> </td> <td><strong>Recovery</strong> </td> </tr> <tr> <td rowspan=\"1\" ><strong>LLM as a judge</strong> </td> <td>Arena Hard </td> <td>25.8 (25.1 / 26.5) </td> <td>27.2 (27.6 / 26.7) </td> <td>105.4% </td> </tr> <tr> <td rowspan=\"8\" ><strong>OpenLLM v1</strong> </td> <td>MMLU (5-shot) </td> <td>68.3 </td> <td>66.9 </td> <td>97.9% </td> </tr> <tr> <td>MMLU (CoT, 0-shot) </td> <td>72.8 </td> <td>71.1 </td> <td>97.6% </td> </tr> <tr> <td>ARC Challenge (0-shot) </td> <td>81.4 </td> <td>80.2 </td> <td>98.0% </td> </tr> <tr> <td>GSM-8K (CoT, 8-shot, strict-match) </td> <td>82.8 </td> <td>82.9 </td> <td>100.2% </td> </tr> <tr> <td>Hellaswag (10-shot) </td> <td>80.5 </td> <td>79.9 </td> <td>99.3% </td> </tr> <tr> <td>Winogrande (5-shot) </td> <td>78.1 </td> <td>78.0 </td> <td>99.9% </td> </tr> <tr> <td>TruthfulQA (0-shot, mc2) </td> <td>54.5 </td> <td>52.8 </td> <td>96.9% </td> </tr> <tr> <td><strong>Average</strong> </td> <td><strong>74.3</strong> </td> <td><strong>73.5</strong> </td> <td><strong>98.9%</strong> </td> </tr> <tr> <td rowspan=\"7\" ><strong>OpenLLM v2</strong> </td> <td>MMLU-Pro (5-shot) </td> <td>30.8 </td> <td>28.8 </td> <td>93.6% </td> </tr> <tr> <td>IFEval (0-shot) </td> <td>77.9 </td> <td>76.3 </td> <td>98.0% </td> </tr> <tr> <td>BBH (3-shot) </td> <td>30.1 </td> <td>28.9 </td> <td>96.1% </td> </tr> <tr> <td>Math-lvl-5 (4-shot) </td> <td>15.7 </td> <td>14.8 </td> <td>94.4% </td> </tr> <tr> <td>GPQA (0-shot) </td> <td>3.7 </td> <td>4.0 </td> <td>109.8% </td> </tr> <tr> <td>MuSR (0-shot) </td> <td>7.6 </td> <td>6.3 </td> <td>83.2% </td> </tr> <tr> <td><strong>Average</strong> </td> <td><strong>27.6</strong> </td> <td><strong>26.5</strong> </td> <td><strong>96.1%</strong> </td> </tr> <tr> <td rowspan=\"2\" ><strong>Coding</strong> </td> <td>HumanEval pass@1 </td> <td>67.3 </td> <td>67.1 </td> <td>99.7% </td> </tr> <tr> <td>HumanEval+ pass@1 </td> <td>60.7 </td> <td>59.1 </td> <td>97.4% </td> </tr> <tr> <td rowspan=\"9\" ><strong>Multilingual</strong> </td> <td>Portuguese MMLU (5-shot) </td> <td>59.96 </td> <td>58.69 </td> <td>97.9% </td> </tr> <tr> <td>Spanish MMLU (5-shot) </td> <td>60.25 </td> <td>58.39 </td> <td>96.9% </td> </tr> <tr> <td>Italian MMLU (5-shot) </td> <td>59.23 </td> <td>57.82 </td> <td>97.6% </td> </tr> <tr> <td>German MMLU (5-shot) </td> <td>58.63 </td> <td>56.22 </td> <td>95.9% </td> </tr> <tr> <td>French MMLU (5-shot) </td> <td>59.65 </td> <td>57.58 </td> <td>96.5% </td> </tr> <tr> <td>Hindi MMLU (5-shot) </td> <td>50.10 </td> <td>47.14 </td> <td>94.1% </td> </tr> <tr> <td>Thai MMLU (5-shot) </td> <td>49.12 </td> <td>46.72 </td> <td>95.1% </td> </tr> </table> ### Reproduction The results were obtained using the following commands: #### MMLU #### MMLU-CoT #### ARC-Challenge #### GSM-8K #### Hellaswag #### Winogrande #### TruthfulQA #### OpenLLM v2 #### MMLU Portuguese #### MMLU Spanish #### MMLU Italian #### MMLU German #### MMLU French #### MMLU Hindi #### MMLU Thai #### HumanEval and HumanEval+ ##### Generation ##### Sanitization ##### Evaluation",
    "model_explanation_gemini": "A quantized version of Meta-Llama-3.1-8B-Instruct optimized for assistant-like chat tasks with reduced memory requirements through INT4 weight quantization."
}